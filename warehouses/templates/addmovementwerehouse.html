{% extends 'core/base.html' %}
{% load static %}
{% block title %}Movimientos de Almacen{% endblock %} 
{% block content %}
<section class="section dashboard">
    <div class="row">

        <div class="col-lg-12">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">
                        Movimientos de Almacen
                    </h5>

                    <!-- Custom Styled Validation -->
                    <form class="row g-3" id="formWarehouseMovement" method="POST">
                        {% csrf_token %}
                        <div class="row">
                            <div class="col-md-4">
                                <div class="row">
                                    <div class="col-md-12">
                                        <label class="form-label">Tipo de Movimiento</label>
                                            {{formtypemovement.typemovement}}
                                    </div>

                                    <div class="col-md-12">
                                        <label class="form-label">Concepto de Almacen</label>
                                        <select class="form-select" id="werehouseConcept" name="concept">
                                            <option selected disabled value="">Seleccionar ...</option>
                                        </select>
                                    </div>
                                    <div class="col-md-12">
                                        <label class="form-label">Almacen</label>
                                        <input type="text" class="form-control" name="werehouse" value="{{request.user.profileuser.warehouse}}" disabled>
                                        <input type="hidden" name="valuetypeMovement" id="valuetypeMovement" value="suma">
                                    </div>
                                    <div class="col-md-12">
                                        <label class="form-label">Observaciones</label>
                                        <textarea name="observation" class="form-control"></textarea>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-8 overflow-y-auto ps-5 pe-5" style="height: 300px;">
                                <table class="table table-hover text-center">
                                    <thead>
                                        <tr>
                                            <th scope="col">Clave</th>
                                            <th scope="col">Producto</th>
                                            <th scope="col">Cantidad</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tableWerehouseMovement">

                                    {% for p in products %}
                                        <tr id="{{p.product.id}}-product">
                                            <th scope="row">{{p.product.id}}</th>
                                            <td>{{p.product.name}}</td>
                                            <td>
                                                <input type="number" class="form-control" id="{{p.product.id}}-price"
                                                    name="{{p.product.id}}-price" value = "0">
                                            </td>
                                        </tr>
                                    {% endfor %}


                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <div class="col-md-2">
                            <label class="form-label">Totales</label>
                            <input type="text" class="form-control" name="total" id="totalMovementWarehouse" readonly disabled>
                        </div>
                        <div class="col-md-12">
                            <button class="btn btn-primary" type="submit">Guardar</button>
                        </div>

                    </form>
                    <!-- End Custom Styled Validation -->

                </div>
            </div>

            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Registro de Almacenes</h5>

                    <!-- Table with hoverable rows -->
                    <table class="table table-hover text-center">
                        <thead>
                            <tr>
                                <th scope="col">ID</th>
                                <th scope="col">Tipo de Movimiento</th>
                                <th scope="col">Concepto</th>
                                <th scope="col">Almacen</th>
                                <th scope="col">Fecha</th>
                                <th scope="col">Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for movements in movements %}
                            <tr>
                               
                                <th scope="row">{{movements.id}}</th>
                                <td>{{movements.typemovement}}</td>
                                <td>{{movements.werehouseconcept}}</td>
                                <td>{{request.user.profileuser.warehouse.title}}</td>
                                <td>{{movements.created |date:"d-m-Y"}}</td>
                                <td>
                                    <a href="{% url 'showreportmovements'  movements.id %}">
                                        <button type="button" class="btn btn-primary">
                                          <i class="bi bi-file-earmark-pdf"></i> Reporte
                                        </button></a
                          
                                </td>
                            </tr>
                            {% endfor %}
                    
                        </tbody>
                    </table>
                    <!-- End Table with hoverable rows -->

                </div>
            </div>
        </div>

    </div>
</section>
{% endblock %}